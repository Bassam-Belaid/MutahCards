CREATE TABLE `Clients` (
  `ClientID` INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
  `Username` VARCHAR(50) CHARACTER SET utf8mb4 NOT NULL UNIQUE,
  `Password` VARCHAR(60) CHARACTER SET utf8mb4 NOT NULL,
  `Balance` DECIMAL(10, 2) NOT NULL
);

CREATE TABLE `CardTypes` (
  `CardTypeID` INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
  `CardTypeValue` DECIMAL(10, 2) NOT NULL UNIQUE
);

CREATE TABLE `Cards` (
  `CardID` INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
  `CardTypeID` INT NOT NULL,
  `ClientID` INT NOT NULL,
  `UserID` BIGINT UNSIGNED DEFAULT NULL,
  `CardCode` VARCHAR(16) NOT NULL UNIQUE,
  `IsRedeemed` TINYINT(1) NOT NULL DEFAULT 0,
  `PurchaseDate` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `RedeemDate` DATETIME DEFAULT NULL,
  FOREIGN KEY (`ClientID`) REFERENCES `Clients`(`ClientID`) ON DELETE CASCADE,
  FOREIGN KEY (`CardTypeID`) REFERENCES `CardTypes`(`CardTypeID`) ON DELETE CASCADE,
  FOREIGN KEY (`UserID`) REFERENCES `users`(`id`) ON DELETE SET NULL
);

-- Indexes for better performance
CREATE INDEX idx_CardCode ON `Cards` (`CardCode`);
CREATE INDEX idx_IsRedeemed ON `Cards` (`IsRedeemed`);
